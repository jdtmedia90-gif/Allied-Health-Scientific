<!-- index.html: Main product page, fully restored -->
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Allied Health Scientific</title>
<link rel="stylesheet" href="style.css">
</head>
<body>
<header>
<div class="logo-container"><h1>Allied Health Scientific</h1></div>
<nav class="toolbar">
<a href="about.html">About Us</a>
<a href="contact.html">Contact</a>
<a href="cart.html">Cart (<span id="cart-count">0</span>)</a>
</nav>
<input type="text" id="search" placeholder="Search products...">
<select id="category-filter"><option value="">All</option></select>
</header>
<main>
<div id="product-list"></div>
</main>
<div id="lightbox" class="hidden">
<span id="close">&times;</span>
<img id="lightbox-img" src="" alt="Product Image">
</div>
<script>
const sheetURL = "https://docs.google.com/spreadsheets/d/1gDRKAFFNtFlox6OyG8fr6y5PMRahFQLy_TQzXatJtwo/gviz/tq?tqx=out:json";
let products = [];
let cart = JSON.parse(localStorage.getItem("site_cart_v1")||"[]");


async function loadProducts(){
try{
const res = await fetch(sheetURL);
const text = await res.text();
const jsonData = JSON.parse(text.substring(47).slice(0,-2));
const rows = jsonData.table.rows;
products = rows.slice(1).map((r,i)=>({
id:r.c[0]?.v?.toString()||"p"+i,
name:r.c[0]?.v||"Unnamed",
category:r.c[1]?.v||"",
price:parseFloat(r.c[2]?.v)||0,
desc:r.c[3]?.v||"",
image:r.c[4]?.v||""
}));
populateCategoryFilter();
displayProducts(products);
updateCartCount();
}catch(err){
console.error(err);
document.getElementById("product-list").innerHTML="<p>Failed to load products.</p>";
}
}


function displayProducts(list){
